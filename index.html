<!DOCTYPE html>
<html>
<head>

	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.6/slate/bootstrap.min.css">


	<!-- Style.CSS -->
	<link rel="stylesheet" href="assets/css/style.css">

	<!--Google Font Arvo Installed -->
	<link href='https://fonts.googleapis.com/css?family=Ubuntu' rel='stylesheet' type='text/css'>

	<!--jQuery-->
	<script src="https://code.jquery.com/jquery-2.2.1.min.js"></script>

	<title>GIFs and Chill?</title>

</head>
<body>
<div class="container">
	<!--Landing Page -->
	<div class="landing">
		<div class="col-lg-12">
			<div class="jumbotron">
				<div class="container">
					<h1>LoveReactor</h1>
					<p>Put your crush to the test.</p>
					<p>
						<a class="btn btn-primary btn-lg start">Get Started</a>
					</p>
				</div>
			</div>
		</div>
	</div>

	<div class="inputs">
		<div class="col-md-6">
			<div class="panel panel-default">
  			<div class="panel-heading">Check Your Match</div>
  				<div class="panel-body">
					<!-- User Input Boxes for Persons One and Two -->
					<div>
						<input id="you" type="text" placeholder=" Your Name">
					</div>

					<div>
						<input id="them" type="text" placeholder=" Your Crush's Name">
					</div>

					<button class="btn btn-primary btn-lg" id="submit">Submit</button>
				</div>
			</div>
		</div>
	</div>
	<div class="match">
		<div class="col-md-6">
			<div class="panel panel-default">
  			<div class="panel-heading">Is It A Match?</div>
  				<div class="panel-body">
					<!-- Display Sections -->
					<div id="percent"></div>					
					<div id="people"></div>
					<div id="result"></div>

					<!-- GIF -->
					<div id="express"></div>
				</div>
			</div>
		</div>
	</div>
</div>
<!-- JavaScript -->
<script type=text/javascript>

var you = "";
var them = "";
var percentage = "";
var result = "";

$(document).ready(function(){
	$(".inputs").hide();
	$(".match").hide();
})

$(".start").on('click', function(){
	$(".landing").hide();
	$(".inputs").show(); 

})

$("#submit").on('click',
	function doIt(){		
	
	$(".match").show();

	// Grabbing the values of user input
	you=$("#you").val().trim();
	them=$("#them").val().trim();

	// The AJAX call for the Love Calculator API
	var output = $.ajax({
			// The URL to the Love Calculator API
    		url: 'https://love-calculator.p.mashape.com/GetPercentage?fname='+you+'&sname='+them, 
    		// The HTTP Method
    		type: 'GET', 
    		data: {}, 
    		dataType: 'json',
    	success: function(data) {

        // console.log(data);
        you = data.fname;
        them = data.sname;
        percentage = data.percentage;
        result = data.result;

        displayInfo();

        gifUpload();
        },
    	error: function(err) { alert(err); },
    	beforeSend: function(xhr) {
    	// Adding the Mashape Key to enable API
    	xhr.setRequestHeader("X-Mashape-Authorization", "ceDOtO1OMAmsh6wrcV74AgQJF5Unp1RjG22jsnf3TthWQqm6jM"); 
    	}

	});  
});




function gifUpload(){
	
	var query = "";

	if(percentage>=80 && percentage<=100){
		query = "celebrate"
	}

	if(percentage>=50 && percentage<=79){
		query = "good+luck"
	}

	if(percentage>=30 && percentage<=49){
		query = "eh"
	}

	if(percentage>=11 && percentage<=29){
		query = "not+good"
	}

	if(percentage>=0 && percentage<=10){
		query = "disaster"
	}
	

	var queryURL = "http://api.giphy.com/v1/gifs/search?q="+ query + "&api_key=dc6zaTOxFJmzC&limit=1&offset=0";

	// var which = Math.floor(Math.random()*(1-1)) + 1;

	// AJAX call for the Giphy API
	$.ajax({url: queryURL, method: 'GET'})

		.done(function(response){

			// console.log(response);

			// console.log(response.data[0].images.downsized.url);
			var gimme = response.data[0].images.downsized.url
			$("#express").html("<img src=" + gimme + ">");
		})
}

function displayInfo(){
       	$('#percent').html("<h1>"+percentage + "% Match </h1>");
	    $('#people').html(you+" & "+them);
       	$('#result').html(result);  
}

</script>
</body>
</html>